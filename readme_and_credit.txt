Most of the code are stolen from:
https://github.com/Jinkela-Xiao-Zuan-Feng-Mountaineer